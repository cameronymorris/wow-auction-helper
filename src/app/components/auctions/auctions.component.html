<div class="panel panel-default">
	<div class="panel-heading">
		<h2 class="panel-title">Auctions</h2>
	</div>
	<div class="panel-body">
		<p>All auctions with no buyout price is ignored.</p> 
		<div class="row col-md-12">
			<form class="form-inline" (ngSubmit)="filterAuctions()" [formGroup]="filterForm">

				<div class="input-group input-group-sm">
					<span class="input-group-addon" id="sizing-addon3">Search</span>
					<input class="col-md-2 form-control" type="text" 
						placeholder="Item name" [formControl]="filterForm.controls['searchQuery']" aria-describedby="sizing-addon3"/>
				</div>

				<div class="input-group input-group-sm">
					<span class="input-group-addon" id="sizing-addon3">Demand</span>
					<input class="col-md-2 form-control" type="text" 
						placeholder="Item name" [formControl]="filterForm.controls['demand']" aria-describedby="sizing-addon3"/>
					<span class="input-group-addon" id="sizing-addon3">%</span>
				</div>

				<div class="input-group input-group-sm">
					<span class="input-group-addon" id="sizing-addon3">Item type</span>
					<select class="form-control" [formControl]="filterForm.controls['itemClass']" aria-describedby="sizing-addon3">
						<option value="-1">All</option>
						<option *ngFor="let i of itemClasses.classes; let p = index;" value="{{ p }}">{{ i.name }}</option>
					</select>
				</div>

				<div class="input-group input-group-sm">
					<span class="input-group-addon" id="sizing-addon3">Sub type</span>
					<select class="form-control" [formControl]="filterForm.controls['itemSubClass']" aria-describedby="sizing-addon3">
						<option value="-1">All</option>
						<option *ngFor="let i of itemClasses.classes[filterForm.value['itemClass']]?.subclasses; let p = index;" value="{{ p }}" >{{ i.name }}</option>
					</select>
				</div>

				<button class="btn btn-primary" type="submit">Apply filter</button>
				<button class="btn btn-default" type="button" (click)="clearFilters()">Clear filter</button>
			</form>
		</div>
		<br>
		<div class="col-md-12">
			<div class="pager">
				<button class="btn btn-default glyphicon glyphicon-arrow-left" (click)="changePage(-1)"></button>
				<input style="width:5em;" type="number" min="1" [(ngModel)]="currentPage" /> of {{ numOfPages }}
				<button class="btn btn-default glyphicon glyphicon-arrow-right" (click)="changePage(1)"></button>
			</div>
			<div class="col-md-8">
				<table class="table table-striped">
					<tr class="row">
						<th>Name</th>
						<th>@AH</th>
						<th (click)="sortAuctions('buyout')">Buyout</th>
						<th>avg Posted/Sold</th>
						<th (click)="sortAuctions('estDemand')">Demand</th>
						<th>Action</th>
					</tr>
					<!-- TODO: optimize price value fetch -->
					<tr class="row" *ngFor="let auc of filteredAuctions | slice:(currentPage - 1)*limit : ((currentPage - 1)*limit) + limit;">
						<td>
							<div>
								<span xmlns="http://www.w3.org/1999/xhtml" class="icon-frame frame-36 align-left" [style.background-image]="'url('+ getIcon(auc) +')'"></span>
								<div class="align-left col-md-offset-1">
									<a rel="item={{ auc.item }}" (click)="selectAuction(auc.auctions)"
										target="_blank">{{ auc.name }} <i class="glyphicon glyphicon-eye-open" aria-hidden="true"></i></a><br>
									{{ auc.owner }}
								</div>
							</div>
						</td>
						<td>{{ auc.quantity_total }} pcs</td>
						<td>
							{{ copperToArray(auc.buyout) }}
						</td>
						<td>
							{{ auc.avgDailyPosted }} <br> {{ auc.avgDailySold }}
						</td>
						<td>
							{{ auc.estDemand }}% 
						</td>
						<td>
							<a class="glyphicon glyphicon-shopping-cart" 
								aria-hidden="true" 
								href="https://eu.battle.net/wow/en/vault/character/auction/browse?reverse=false&sort=unitBuyout&itemId={{auc.item}}"
								target="_blank">Buy</a><br>
							<a class="glyphicon glyphicon-exclamation-sign" 
								aria-hidden="true" 
								href="http://www.wowhead.com/item={{auc.item}}"
								target="_blank">Wowhead</a><br>
						</td>
					</tr>
				</table>
			</div>
			<div class="col-md-4">
				<table class="table table-striped">
					<tr class="row">
						<th>Item</th>
						<th>Auction</th>
						<th>Per item</th>
						<th>Stack size</th>
					</tr>
					<tr class="row" *ngFor="let a of selectedAuctions  | slice:0 : 10;">
						<td>
							<div>
								<span xmlns="http://www.w3.org/1999/xhtml" class="icon-frame frame-36 align-left" [style.background-image]="'url('+ getIcon(a) +')'"></span>
								<div class="align-left col-md-offset-1">
									<a
										href="https://eu.battle.net/wow/en/vault/character/auction/browse?reverse=false&sort=unitBuyout&itemId={{a.item}}"
										target="_blank">{{ a.name }}<i class="glyphicon glyphicon-shopping-cart" aria-hidden="true"></i></a><br>
									{{ a.owner }}
								</div>
							</div>
						</td>
						<td>{{ copperToArray(a.buyout) }}</td>
						<td>{{ copperToArray(a.buyout / a.quantity) }}</td>
						<td>{{ a.quantity }}</td>
					</tr>
				</table>
			</div>
		</div>
		<div class="pager">
			<button class="btn btn-default glyphicon glyphicon-arrow-left" (click)="changePage(-1)"></button>
			<input style="width:5em;" type="number" min="1" [(ngModel)]="currentPage" /> of {{ numOfPages }}
			<button class="btn btn-default glyphicon glyphicon-arrow-right" (click)="changePage(1)"></button>
		</div>
	</div>
</div>
