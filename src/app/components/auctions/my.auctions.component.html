<div class="panel panel-default mat-elevation-z6">
	<div class="panel-heading">
		<h2 class="panel-title">My auctions</h2>
	</div>
	<div class="panel-body">
		<ul>
			<li>{{ numberOfUndercuttedAuctions }} of {{ activeAuctions }} your auctions are undercutted.</li>
			<li>Value of auctions: {{ auctionsValue | gold }}.</li>
		</ul>

		<p *ngIf="apiToUse === 'none'" class="alert alert-info" role="alert">
				If you want information indicating the demand of an item, then it's recommended that you either add a TSM or WoWuction API.
				You can get a TSM key <a href="https://www.tradeskillmaster.com/user" target="_blank">here</a>.
		</p>

		<div class="col-md-12 row">
			<div class="col-md-8">
				<mat-paginator
					[length]="numberOfUndercuttedAuctions"
					[pageSize]="page.pageSize"
					[pageSizeOptions]="page.pageSizeOptions"
					[pageIndex]="pageEvent.pageIndex"
					(page)="changePage($event)">
				</mat-paginator>
				<table class="table table-striped row">
					<tr class="row">
						<th (click)="sort('name')">
							<app-sort-icon [key]="sorter.getKey('name')"></app-sort-icon>
							Name
						</th>
						<th (click)="sort('quantity')">
								<app-sort-icon [key]="sorter.getKey('quantity')"></app-sort-icon>
							Size
						</th>
						<th (click)="sort('buyout')">
							<app-sort-icon [key]="sorter.getKey('buyout')"></app-sort-icon>
							Buyout
						</th>
						<th *ngIf="apiToUse !== 'none'" class="hidden-xs">
							<span *ngIf="apiToUse === 'tsm'">Regional avg </span>
							<span *ngIf="apiToUse === 'wowuctions'">Avg posted/</span>
							sold
						</th>
						<th *ngIf="apiToUse !== 'none'" class="hidden-xs" (click)="sort('estDemand')">
								<app-sort-icon [key]="sorter.getKey('estDemand')"></app-sort-icon>
							<span *ngIf="apiToUse === 'tsm'">Region est Demand</span>
							<span *ngIf="apiToUse === 'wowuctions'">est demand/</span>
						</th>
					</tr>
					<tr class="row" *ngFor="let auc of getAuctions() |
						slice: 
							(pageEvent.pageSize * (pageEvent.pageIndex + 1)) - pageEvent.pageSize:
							pageEvent.pageSize * (pageEvent.pageIndex + 1);"
						[ngClass]="{info: getAuctionOwner(auc.item) !== character}">
						<td>
							<div>
								<span xmlns="http://www.w3.org/1999/xhtml" class="icon-frame frame-36 align-left" [style.background-image]="'url('+ getIcon(auc) +')'">
								</span>
								<div class="align-left col-md-9">
									<a rel="item={{ auc.item }}" (click)="selectAuction(auc)"
										target="_blank">{{ auc.name }} <i class="glyphicon glyphicon-eye-open" aria-hidden="true"></i></a>
								</div>
							</div>
						</td>
						<td>{{ auc.quantity }}</td>
						<td>
							{{ auc.buyout | gold }} ({{ auc.buyout / auc.quantity | gold }} pcs)
						</td>
						<td *ngIf="apiToUse !== 'none'" class="hidden-xs">
							<span *ngIf="apiToUse === 'wowuctions'">
								{{ auc.avgDailyPosted }} <br>
							</span>
							 {{ auc.avgDailySold }}
						</td>
						<td *ngIf="apiToUse !== 'none'" class="hidden-xs">
							{{ auc.estDemand }}%
						</td>
					</tr>
				</table>
				<mat-paginator
					[length]="numberOfUndercuttedAuctions"
					[pageSize]="page.pageSize"
					[pageSizeOptions]="page.pageSizeOptions"
					[pageIndex]="pageEvent.pageIndex"
					(page)="changePage($event)">
				</mat-paginator>
			</div>
			<div class="col-md-4">
				<mat-paginator
					[length]="selectedAuctions.length"
					[pageSize]="page.pageSize"
					[pageSizeOptions]="page.pageSizeOptions"
					[pageIndex]="pageEventSecondary.pageIndex"
					(page)="changePage($event, true)">
				</mat-paginator>
				<table class="table table-striped row">
					<tr class="row">
						<th>Item</th>
						<th>Auction</th>
						<th>Per item</th>
						<th>Size</th>
					</tr>
					<tr class="row" *ngFor="let a of selectedAuctions |
						slice: 
							(pageEventSecondary.pageSize * (pageEventSecondary.pageIndex + 1)) - pageEventSecondary.pageSize:
							pageEventSecondary.pageSize * (pageEventSecondary.pageIndex + 1);">
						<td>
							<div>
								<span xmlns="http://www.w3.org/1999/xhtml" class="icon-frame frame-36 align-left" [style.background-image]="'url('+ getIcon(a) +')'"></span>
								<div class="align-left col-md-offset-1">
									<a
										rel="item={{ a.item }}"
										href="https://{{ user.region }}.battle.net/wow/en/vault/character/auction/browse?reverse=false&sort=unitBuyout&itemId={{ a.item }}"
										target="_blank">{{ a.name }}<i class="glyphicon glyphicon-shopping-cart" aria-hidden="true" ></i></a><br>
									{{ a.owner }} @ {{ a.ownerRealm }}
								</div>
							</div>
						</td>
						<td>{{ a.buyout | gold }}</td>
						<td>{{ a.buyout / a.quantity | gold }}</td>
						<td>{{ a.quantity }}</td>
					</tr>
				</table>
				<mat-paginator
					[length]="selectedAuctions.length"
					[pageSize]="page.pageSize"
					[pageSizeOptions]="page.pageSizeOptions"
					[pageIndex]="pageEventSecondary.pageIndex"
					(page)="changePage($event, true)">
				</mat-paginator>
			</div>
		</div>
	</div>
</div>
