<div class="panel panel-default">
  <div class="row col-md-12">
    <div class="col-lg-9">
      <h2>Settings</h2>
    </div>
    <div class="col-lg-3">
      <button class="btn btn-primary mat-elevation-z5 float-right" (click)="saveUserData()">
        Save all changes
      </button>
      <button class="btn btn-default mat-elevation-z5 float-right mr-2" (click)="changeStyle()">
        Turn dark mode {{ darkMode ? 'off' : 'on' }}
      </button>
    </div>
  </div>
  <mat-tab-group>
    <mat-tab label="Realm, Seller & API">
      <p>
        Realm and region are requiered, while the character name is not. However, you will not be able to see if you have been undercutted
        if you don't.
      </p>
      <form class="form-inline" (ngSubmit)="getCharacter()" [formGroup]="characterForm">
        <mat-form-field class="col-md-2">
          <mat-select placeholder="Region" formControlName="region">
            <mat-option *ngFor="let r of getRegions()" [value]="r">
              {{ r }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field class="col-md-3">
          <mat-select placeholder="Realm" formControlName="realm">
            <mat-option *ngFor="let r of regions?.eu.realms" [value]="r.slug">
              {{ r.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field class="col-md-6">
          <input matInput placeholder="Character" formControlName="name">
        </mat-form-field>
      </form>

      <h3>API</h3>
      <p>
        If you want information indicating the demand of an item, then it's recommended that you either add a TSM or WoWuction API.
        You can get a TSM key
        <a href="https://www.tradeskillmaster.com/user" target="_blank">here</a>.
      </p>
      <!--<div class="input-group input-group-sm">
            <span class="input-group-addon" id="basic-addon1">WoWuction key</span>
            <input class="form-control" name="wowuction" placeholder="API key" type="text" [(ngModel)]="user.apiWoWu" aria-describedby="basic-addon1"/>
          </div>-->

      <div class="input-group input-group-sm">
        <span class="input-group-addon" id="basic-addon1">TSM key</span>
        <input class="form-control" name="tsm" placeholder="API key" type="text" [(ngModel)]="user.apiTsm" aria-describedby="basic-addon1"
        />
      </div>

      <div class="input-group input-group-sm">
        <span class="input-group-addon" id="basic-addon1">API to use:</span>
        <select class="form-control" aria-describedby="basic-addon1" [(ngModel)]="user.apiToUse">
          <option value="none">None</option>
          <option value="tsm">TSM</option>
          <!--<option value="wowuction">WoWuction</option>-->
        </select>
      </div>

      <h3>Stored data</h3>
      <div class="input-group">
        <span class="input-group-btn">
          <button class="btn btn-default mat-elevation-z5" (click)="importUserData()">Import settings</button>
        </span>
        <textarea type="text" class="form-control" placeholder="Paste in the exported string here" [(ngModel)]="importedSettings"></textarea>
      </div>
      <div class="input-group">
        <span class="input-group-btn">
          <button class="btn btn-default mat-elevation-z5" (click)="exportUserData()">Export settings</button>
        </span>
        <textarea type="text" class="form-control" placeholder="Copy the exported string from here" [(ngModel)]="exportedSettings"></textarea>
      </div>

      <button class="btn btn-default mat-elevation-z5" (click)="deleteUserData()">Delete settings</button>
    </mat-tab>
    <mat-tab label="Crafting">
      <div class="input-group input-group-sm">
        <span class="input-group-addon" id="basic-addon1">
          Use market value instead of buyout if buyout >=
        </span>
        <input class="form-control" placeholder="API key" type="number" [(ngModel)]="user.buyoutLimit" aria-describedby="basic-addon1"
        />
        <span class="input-group-addon" id="basic-addon1">
          % of the market value.
        </span>
      </div>
      <strong>Custom item prices</strong>
      <p>These prices are ovrrides for cost calculation. Using trade vendor panel values coming soonâ„¢</p>
      <form class="form-inline" (ngSubmit)="searchDB()" [formGroup]="customPriceForm">
        <div class="input-group input-group-sm col-md-12">
          <label class="sr-only" for="Item">Search for an item</label>
          <input type="text" class="form-control" name="Item" placeholder="Search for the desiered item" type="text" aria-describedby="basic-addon1"
            [formControl]="customPriceForm.controls['query']">
          <button id="sizing-addon1" class="input-group-addon btn btn-default mat-elevation-z5" (click)="searchDB()">
            Search
            <i class="fa fa-search">
            </i>
          </button>
        </div>
      </form>
      <ul class="list-group">
        <li class="list-group-item" *ngFor="let item of customPriceQueryItems">
          {{ item.name}}
          <i class="fa fa-plus pull-right" (click)="addCustomPrice(item)"></i>
        </li>
      </ul>
      <table class="table table-striped">
        <tr>
          <th>item</th>
          <!--<th>Category</th>-->
          <th>Price copper input</th>
          <th>Value in gold</th>
          <th>Action</th>
        </tr>
        <tr *ngFor="let cp of customPrices; let i = index;">
          <td>{{getItemName(cp.itemID)}} ({{cp.itemID}})</td>
          <!--<td>
                <select [(ngModel)]="cp.category">
                  <option value="fallback">Fallback</option>
                  <option value="vendor">Vendor</option>
                  <option value="soulbound">Soulbound</option>
                </select>
              </td>-->
          <td>
            <input type="number" [(ngModel)]="cp.price" />
          </td>
          <td>{{ cp.price | gold }}</td>
          <td>
            <i class="fa fa-trash pull-right" (click)="removeCustomPrice(i)"></i>
          </td>
        </tr>
      </table>
      <app-characters [region]="user.region" [realm]="user.realm"></app-characters>
    </mat-tab>
    <mat-tab label="Notifications">
      <p>Here you can turn on and off the various notifications in the application.</p>

      <div class="col-md-6">
        <strong>API independent</strong>
        <ul class="list-group">
          <li class="list-group-item">
            <span class="badge">
              <input type="checkbox" [(ngModel)]="user.notifications.isUpdateAvailable">
            </span>
            Auction house updates
          </li>
          <li class="list-group-item">
            <span class="badge">
              <input type="checkbox" [(ngModel)]="user.notifications.isBelowVendorSell">
            </span>
            Items below vendor sell price
          </li>
          <li class="list-group-item">
            <span class="badge">
              <input type="checkbox" [(ngModel)]="user.notifications.isUndercutted">
            </span>
            If {{ user.character }} is undercutted
          </li>
          <li class="list-group-item">
            <span class="badge">
              <input type="checkbox" [(ngModel)]="user.notifications.isWatchlist">
            </span>
            Allow the watchlist to send notifications.
            <br>
            <em>If you wish to turn of individual items, do that on the watchlist page</em>
          </li>
        </ul>
      </div>
      <!--<div class="col-md-6">
                  <strong>API dependent</strong>
                  <ul class="list-group">
                    <li class="list-group-item">
                      <span class="badge">
                        <input type="checkbox">
                      </span>
                      Something
                    </li>
                    <li class="list-group-item">
                      <span class="badge">
                        <input type="checkbox">
                      </span>
                      Something else
                    </li>
                  </ul>
                </div>-->
    </mat-tab>
  </mat-tab-group>
</div>